[% PROCESS 'report/new/form_heading.html' %]

[% TRY %][% INCLUDE 'report/new/roads_message.html' %][% CATCH file %][% END %]

<fieldset>
    <div id="problem_form">

        [% IF report.used_map %]
            <ul class="change_location visually-hidden">
                <li class="change_location__map">[% loc('Click the map or drag the pin to adjust the location') %]</li>
                <li class="change_location__search">[% loc('Or <a href="/">search for a different location</a>') %]</li>
            </ul>
        [% END %]

        <div id="js-top-message">
            [% PROCESS 'report/new/top_message.html' %]
        </div>

        [% IF report.used_map && partial_token %]
            <p id="unknown">[% loc('Please note your report has <strong>not yet been sent</strong>. Choose a category and add further information below, then submit.') %]</p>
        [% END %]
        [% IF oauth_failure %]
            <p class="form-error">[% loc('Sorry, we could not log you in. Please fill in the form below.') %]</p>
        [% END %]

        [% INCLUDE 'errors.html' %]

        [% IF field_errors.bodies %]
            <p class='form-error'>[% field_errors.bodies %]</p>
        [% END %]

        <div data-page-name="category" class="js-reporting-page js-reporting-page--category js-reporting-page--active dropdowns">
           
            [% IF public_councils_text_at_top %]
                [% INCLUDE public_councils_text %]
            [% END %]
        
            [% PROCESS "report/new/category_wrapper.html" %]
            [% TRY %][% PROCESS 'report/new/after_category.html' %][% CATCH file %][% END %]

            [% INCLUDE 'report/new/form_title.html' %]
                        
            <div class="continue-container-two">
                <button class="js-back button primary-button-two" tabindex="0" aria-label="previous step"><span class="arrow-left"></span>[% loc('Back') %]</button>
                <button class="hidden-nojs js-reporting-page--next button primary-button" tabindex="0" aria-label="continue to next step"
                [% ' disabled' IF disable_form_message %]>[% loc('Continue') %]<span class="arrow-right"></span></button>
            </div> 

        </div>

        <div data-page-name="details" class="js-reporting-page">
            [% UNLESS public_councils_text_at_top %]
              [% INCLUDE public_councils_text %]
            [% END %]
          
              [% DEFAULT form_detail_label = loc('Explain what’s wrong') %]
              <label for="form_detail">[% form_detail_label %]</label>
          
              [%# You can prevent a hint being printed by setting form_detail_placeholder to a Falsey value %]
            [% IF NOT form_detail_placeholder.defined %]
              [% SET form_detail_placeholder = loc('e.g. ‘This pothole has been here for two months and…’') %]
            [% END %]
          
            [% IF contact_detail_hint %]
              <p class="form-hint" id="detail-hint">[% contact_detail_hint %]</p>
            [% ELSIF form_detail_placeholder %]
              <p class="form-hint" id="detail-hint">[% form_detail_placeholder %]</p>
            [% END %]
          
            [% IF field_errors.detail %]
              <p class='form-error'>[% field_errors.detail %]</p>
            [% END %]
          
              <textarea class="form-control" rows="7" cols="26" name="detail" id="form_detail" [% IF form_detail_placeholder %]aria-describedby="detail-hint"[% END %][% field_required %]>[% report.detail | html %]</textarea>
          
              [% TRY %][% PROCESS 'report/new/inline-tips.html' %][% CATCH file %][% END %]
          
              <div class="js-reporting-page--single-hidden">
                  [% PROCESS report/form/user.html type='report' %]
              </div>
          </div>

    </div>
</fieldset>